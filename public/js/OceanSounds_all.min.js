/*! OceanSounds 2015-11-10 */
var PLBAudioController=function(a){this.playerId=a,this.audioPlayerElement=document.getElementById(a),this.isPlaying=!1};PLBAudioController.prototype.loadThenPlay=function(a){var b=a.replace(".mp3",".ogg");return document.getElementById("mp3Source").src=a,document.getElementById("oggSource").src=b,this.audioPlayerElement.load(),this.audioPlayerElement.play(),this.isPlaying=!0,!0},PLBAudioController.prototype.pause=function(){return this.audioPlayerElement.pause(),this.isPlaying=!1,!0},PLBAudioController.prototype.play=function(){return this.audioPlayerElement.play(),!0};var OceanInterfaceManager=function(a,b,c){return console.log("* OceanInterfaceManager Init *"),a?b?c?(this.oDBMgr=a,this.oAudioController=b,this.oViewMgr=c,this.currentSelection=0,this.lastSelection=-1,this.isMuted=!1,this.playButtonVisibilityState=this.setupPlayButtonVisibilityStates(),void this.setupAllOceanListeners()):void console.error("ERROR - OceanInterfaceManager requires an OceanViewManager class reference to initialize.  Exiting..."):void console.error("ERROR - OceanInterfaceManager requires aAudioPlayer class (maybe PLBAudioController?) to initialize.  Exiting..."):void console.error("ERROR - OceanInterfaceManager requires an OceanDatabaseManager class reference to initialize.  Exiting...")};OceanInterfaceManager.prototype.setupAllOceanListeners=function(){for(var a=this.oDBMgr.getDatabaseLength(),b=this,c=function(a){return function(){b.playerClicked(a)}},d=function(a){return function(){b.playerMouseover(a)}},e=function(a){return function(){b.playerMouseleave(a)}},f=0;a>f;f++)$(".oceanChild:nth("+f+")").on("click",c(f)),$(".oceanChild:nth("+f+")").on("mouseover",d(f)),$(".oceanChild:nth("+f+")").on("mouseleave",e(f))},OceanInterfaceManager.prototype.setupPlayButtonVisibilityStates=function(){for(var a=this.oDBMgr.getDatabaseLength(),b=[],c=0;a>c;c++)b.push(!0);return b},OceanInterfaceManager.prototype.playerMouseover=function(a){this.oAudioController.isPlaying&&this.currentSelection===a||$("#oc"+a+".oceanChild .ocImageDiv").removeClass("blendModeEnabled")},OceanInterfaceManager.prototype.playerMouseleave=function(a){this.oAudioController.isPlaying&&this.currentSelection===a||$("#oc"+a+".oceanChild .ocImageDiv").addClass("blendModeEnabled")},OceanInterfaceManager.prototype.playerClicked=function(a){this.currentSelection=a,$("#locAudioBut"+this.currentSelection).removeClass("pauseButtonImage").addClass("playButtonImage"),oAudioController.pause(),this.setMuteToOff();var b=!1;this.currentSelection===this.lastSelection&&(b=!this.playButtonVisibilityState[this.currentSelection]);for(var c=0;c<this.playButtonVisibilityState.length;c++)this.playButtonVisibilityState[c]=!0,$("#locAudioBut"+c).removeClass("pauseButtonImage").addClass("playButtonImage"),$("#oc"+c+".oceanChild .ocImageDiv").addClass("blendModeEnabled");this.playButtonVisibilityState[this.currentSelection]=b,this.playButtonVisibilityState[this.currentSelection]||(oAudioController.loadThenPlay(this.oDBMgr.getAudioData_audioFileNameWithPath(this.currentSelection)),$("#locAudioBut"+this.currentSelection).removeClass("playButtonImage").addClass("pauseButtonImage"),$("#oc"+this.currentSelection+".oceanChild .ocImageDiv").removeClass("blendModeEnabled")),this.lastSelection=this.currentSelection},OceanInterfaceManager.prototype.muteToggle=function(){$("#muteButton").toggleClass("mutedMode"),this.isMuted=!this.isMuted,this.isMuted?oAudioController.pause():oAudioController.play()},OceanInterfaceManager.prototype.setMuteToOff=function(){$("#muteButton").removeClass("mutedMode"),this.isMuted=!1},OceanInterfaceManager.prototype.mapMoveLeft=function(){this.currentSelection>0&&this.currentSelection--,this.playerClicked(this.currentSelection)},OceanInterfaceManager.prototype.mapMoveRight=function(){var a=this.oDBMgr.getDatabaseLength();this.currentSelection<a-1&&this.currentSelection++,this.playerClicked(this.currentSelection)},OceanInterfaceManager.prototype.drawPinsWithSelection=function(a){var b=this.oDBMgr.getDatabaseLength();$("#leftArrowButton").removeClass("disabled"),$("#rightArrowButton").removeClass("disabled"),0===a?$("#leftArrowButton").addClass("disabled"):a===b-1&&$("#rightArrowButton").addClass("disabled"),$("#pinId0").animate({position:"relative",left:this.oDBMgr.audioDatabase[a].xpos+"px",top:this.oDBMgr.audioDatabase[a].ypos+"px",opacity:"1.00"},1e3,"swing",function(){$("#pinId0").html("<div>"+function(){this.oDBMgr.getAudioData_locationName(a)}+"</div>")})};var OceanLocationElementCreator=function(a){return console.log("* OceanViewManger Init *"),a?(this.oDBMgr=a,void(this.colorArray=["rgba(200,0,0,0.66)","rgba(32,255,32,0.5)","rgba(255,100,0,0.66)","rgba(32,32,255,0.75)","rgba(200,32,200,0.5)","rgba(250,250,32,0.75)"])):void console.error("ERROR - OceanViewManager requires an OceanDatabaseManager() reference to initialize.  Exiting OceanLocationElementCreator()...")};OceanLocationElementCreator.prototype.drawAllOceans=function(){for(var a=this.oDBMgr.getDatabaseLength(),b=0;a>b;b++)this.drawEachOcean(b,"#oc"+b)},OceanLocationElementCreator.prototype.getOceanColor=function(a){for(var b=a,c=this.colorArray.length;b>c-1;)b-=c;return this.colorArray[b]},OceanLocationElementCreator.prototype.drawEachOcean=function(a,b){var c=this.oDBMgr.getAudioDatabase(),d=c[a].locationName,e=c[a].thumb_image_URL,f='<li id="oc'+a+'" class="oceanChild"><div class="ocImageDiv"><div id="locAudioBut'+a+'" class="buttonImage" style="width:75px;height:75px;" ></div><div class="ocTextDiv"><p>'+d+"</p></div></li>";$(f).insertAfter(b),$("#locAudioBut"+a).addClass("playButtonImage"),$("#oc"+a+".oceanChild .ocImageDiv").css({"background-image":"url( images/locations/"+e+" )","background-color":this.colorArray[a]}).addClass("blendModeEnabled")};var OceanDatabaseManager=function(){console.log("* OceanDatabaseManager Init *"),this.AUDIOPATH="/audio/ocean/",this.audioDatabase=[{audioFilename:"164767__rucisko__ocean-waves_Coimbra_Portugal.mp3",locationName:"Figueria da Foz, Portugal",locationCountry:"Portugal",thumb_image_URL:"Coimbra_Portugal_thumb.jpg",rating:"5",xpos:"32",ypos:"164",volumeAdj:0},{audioFilename:"20140316-064528-Indonedia-SeaOfJava.mp3",locationName:"Indonesia, Java Sea",locationCountry:"Indonesia",thumb_image_URL:"20140316-064528-Indonedia-SeaOfJava_thumb.jpg",rating:"4",xpos:"267",ypos:"264",volumeAdj:0},{audioFilename:"166214__abcopen__southern-ocean__Warrnambool_Australia_Levys-Beach.mp3",locationName:"Levy's Beach, Warrnambool, Australia",locationCountry:"Australia",thumb_image_URL:"Levys-Beach_Warrnambool_Australia_thumb.jpg",rating:"5",xpos:"356",ypos:"372",volumeAdj:0},{audioFilename:"frenchPolynesia.mp3",locationName:"French Polynesia",locationCountry:"French Polynesia",thumb_image_URL:"fakarava_island_french_polynesia_thumb.jpg",rating:"4",xpos:"438",ypos:"259",volumeAdj:0},{audioFilename:"OceanBeach-LandsEndwFogHorn.mp3",locationName:"Land's End, San Francisco CA, USA",locationCountry:"United States",thumb_image_URL:"OceanBeach-LandsEndwFogHorn_thumb.jpg",rating:"5",xpos:"543",ypos:"160",volumeAdj:0}]};OceanDatabaseManager.prototype.getAudioData_audioFileNameWithPath=function(a){var b=this.AUDIOPATH+this.audioDatabase[a].audioFilename;return b},OceanDatabaseManager.prototype.getAudioDatabase=function(a){return this.audioDatabase},OceanDatabaseManager.prototype.getAudioDataObject=function(a){return a>=0&&a<this.audioDatabase.length?this.audioDatabase:void alert("ERROR - Invalid audio object id.")},OceanDatabaseManager.prototype.getAudioData_locationName=function(a){var b=this.getAudioDataObject(a);return b.locationName},OceanDatabaseManager.prototype.getAudioData_rating=function(a){var b=this.getAudioDataObject(a);return b.rating},OceanDatabaseManager.prototype.getAudioData_xpos=function(a){var b=this.getAudioDataObject(a);return b.xpos},OceanDatabaseManager.prototype.getAudioData_ypos=function(a){var b=this.getAudioDataObject(a);return b.ypos},OceanDatabaseManager.prototype.getDatabaseLength=function(){return this.audioDatabase.length};var oDatabaseMgr,oAudioController,oLocationElementCreator,oInterfaceMgr,audioPlayerClicked=function(a){console.log(">> audioPlayerClicked( "+a+")!!!"),oInterfaceMgr.playerClicked(a)},listenersSetup=function(){$("#leftArrowButton").click(function(){oInterfaceMgr.setMuteToOff(),oInterfaceMgr.mapMoveLeft()}),$("#rightArrowButton").click(function(){oInterfaceMgr.setMuteToOff(),oInterfaceMgr.mapMoveRight()}),$("#muteButton").click(function(){oInterfaceMgr.muteToggle()}),$(document).keydown(function(a){switch(a.which){case 37:console.log("left"),oInterfaceMgr.mapMoveLeft();break;case 38:console.log("volume up"),oInterfaceMgr.muteToggle();break;case 39:console.log("right"),oInterfaceMgr.mapMoveRight();break;case 40:console.log("volume down"),oInterfaceMgr.muteToggle();break;default:return}})};$(document).ready(function(){listenersSetup(),oDatabaseMgr=new OceanDatabaseManager,oAudioController=new PLBAudioController("audioPlayerId"),oLocationElementCreator=new OceanLocationElementCreator(oDatabaseMgr),oLocationElementCreator.drawAllOceans(),oInterfaceMgr=new OceanInterfaceManager(oDatabaseMgr,oAudioController,oLocationElementCreator)});